import{r as w,b as S,o,d as g,w as x,e as p,f as c,u as $,i as k,t as L,s as B,v as C,j as d,x as P,h as m,c as u,y as V,F as D,k as U,l as b,a as H}from"./index-ff61e4a8.js";const N={alt:"",class:"search__img"},T={class:"search__name"},j={__name:"SearchItem",props:["item"],setup(t){return(a,n)=>{const e=w("router-link"),s=S("lazy");return o(),g(e,{to:`/${t.item.media_type}/${t.item.id}`,class:"search__item"},{default:x(()=>[p(c("img",N,null,512),[[s,$(k)+t.item.poster_path]]),c("h3",T,L(t.item.title||t.item.name),1)]),_:1},8,["to"])}}},z=B("search",{state:()=>({searchList:[],search:"",totalPages:1}),actions:{async getSearch(t=1){try{const n=await(await fetch(`https://api.themoviedb.org/3/search/multi?query=${this.search}&include_adult=false&language=en-US&page=${t}`,C)).json();this.totalPages=n.total_pages;let e=n.results.filter(s=>s.media_type=="movie"||s.media_type=="tv");t>1?this.searchList.push(...e):this.searchList=e}catch(a){console.log(a)}}}}),E={class:"search container"},F={class:"search__wrapper"},q={key:0,class:"loading"},A=c("div",{class:"loading__spiner"},null,-1),I=[A],M={__name:"SearchContent",setup(t){let a=null;function n(r,l){clearTimeout(a),a=setTimeout(()=>{r()},l)}const e=z(),s=d({get:()=>e.search,set:r=>{e.search=r,n(e.getSearch,500)}}),v=d(()=>e.searchList);P(()=>{e.search="",e.searchList=[]});const h=m(1),i=m(!1),f=d(()=>e.totalPages);async function y(){!i.value&&h.value<f.value&&(i.value=!0,h.value++,await e.getSearch(h.value),i.value=!1)}return window.addEventListener("scroll",()=>{window.scrollY+window.innerHeight>=document.body.clientHeight-footer.clientHeight&&y()}),(r,l)=>(o(),u("section",E,[p(c("input",{"onUpdate:modelValue":l[0]||(l[0]=_=>s.value=_),type:"text",class:"search__input",placeholder:"Найти фильм, сериал..."},null,512),[[V,s.value]]),c("div",F,[(o(!0),u(D,null,U(v.value,(_,G)=>(o(),g(j,{item:_},null,8,["item"]))),256))]),i.value?(o(),u("div",q,I)):b("",!0)]))}},Y={class:"main"},K={__name:"Search",setup(t){return(a,n)=>(o(),u("main",Y,[H(M)]))}};export{K as default};
